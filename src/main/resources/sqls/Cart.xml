<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.lotte.carts.dao.CartDao">

    <!-- 장바구니 목록 (장바구니 아이템 목록) 조회 쿼리 -->
    <select id="selectCartItemsByCartNo"
      resultType="com.lotte.carts.dto.CartItemDto"
      parameterType="Integer">

        SELECT cart_item_no cartItemNo, p.product_no productNo, product_name productName,
               product_simple_content productSimpleContent, product_img_new_name productImgNewName,
               cart_item_count cartItemCount, cart_item_total_price cartItemTotalPrice
        FROM (SELECT cart_item_no, product_no, cart_item_count,
                     cart_item_total_price
              FROM cart_items
              WHERE cart_no = #{cartNo}) ci, product_imgs pi, products p
        WHERE ci.product_no = pi.product_no AND pi.product_no = p.product_no;

    </select>
</mapper>